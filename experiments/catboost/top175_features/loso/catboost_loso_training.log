Output directory: experiments/catboost/top175_features

============================================================
Step 1: Loading Data
============================================================
Loading 18 station files from /home/zhengkun-li/frost-risk-forecast-challenge/data/raw/frost-risk-forecast-challenge/stations...
  Loaded 5/18 files...  Loaded 10/18 files...  Loaded 15/18 files...  Loaded 18/18 files...
Combining 18 station DataFrames...
Combined data: 2367360 rows, 26 columns
Stations: 18
Loaded 2367360 rows, 26 columns
Optimizing data types to reduce memory...
Memory usage after optimization: 1.50 GB

============================================================
Step 2: Cleaning Data
============================================================
After cleaning: 2367360 rows

============================================================
Step 3: Feature Engineering
============================================================
After feature engineering: 2367360 rows, 313 columns
Memory usage: 3.95 GB
Optimizing feature data types...
Memory usage after optimization: 3.95 GB

============================================================
Step 4: Creating Frost Labels
============================================================
  3h horizon: 20579.0/2367360 frost events (0.87%)
  6h horizon: 20579.0/2367360 frost events (0.87%)
  12h horizon: 20579.0/2367360 frost events (0.87%)
  24h horizon: 20579.0/2367360 frost events (0.87%)

Saved labeled data to experiments/catboost/top175_features/labeled_data.parquet

Using top 175 features based on importance
  Importance file: /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv

============================================================
Training models for 3h horizon
============================================================
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
Features: 175
Samples: 2367306
Frost events: 20579.0 (0.87%)
Train: 1657078, Val: 355087, Test: 355090

Training classification model for frost probability...
Training regression model for temperature...

Evaluating on test set...

Classification Metrics (Frost Probability):
accuracy: 0.9964
brier_score: 0.0027
ece: 0.0009
f1: 0.6555
fn: 700
fp: 571
pr_auc: 0.7184
precision: 0.6792
recall: 0.6333
roc_auc: 0.9965
tn: 352610
tp: 1209

Regression Metrics (Temperature):
mae: 1.1950
mape: 13.0662
r2: 0.9681
rmse: 1.5792

Generating reliability diagram...

============================================================
Training models for 6h horizon
============================================================
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
Features: 175
Samples: 2367252
Frost events: 20579.0 (0.87%)
Train: 1657004, Val: 355070, Test: 355076

Training classification model for frost probability...
Training regression model for temperature...

Evaluating on test set...

Classification Metrics (Frost Probability):
accuracy: 0.9952
brier_score: 0.0036
ece: 0.0019
f1: 0.5311
fn: 935
fp: 785
pr_auc: 0.5382
precision: 0.5537
recall: 0.5102
roc_auc: 0.9929
tn: 352382
tp: 974

Regression Metrics (Temperature):
mae: 1.5938
mape: 17.7774
r2: 0.9452
rmse: 2.0713

Generating reliability diagram...

============================================================
Training models for 12h horizon
============================================================
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
Features: 175
Samples: 2367144
Frost events: 20579.0 (0.87%)
Train: 1656856, Val: 355036, Test: 355048

Training classification model for frost probability...
Training regression model for temperature...

Evaluating on test set...

Classification Metrics (Frost Probability):
accuracy: 0.9949
brier_score: 0.0038
ece: 0.0020
f1: 0.4733
fn: 1102
fp: 694
pr_auc: 0.4914
precision: 0.5376
recall: 0.4227
roc_auc: 0.9883
tn: 352445
tp: 807

Regression Metrics (Temperature):
mae: 1.8365
mape: 20.8520
r2: 0.9267
rmse: 2.3952

Generating reliability diagram...

============================================================
Training models for 24h horizon
============================================================
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
Features: 175
Samples: 2366928
Frost events: 20579.0 (0.87%)
Train: 1656561, Val: 354967, Test: 354992

Training classification model for frost probability...
Training regression model for temperature...

Evaluating on test set...

Classification Metrics (Frost Probability):
accuracy: 0.9931
brier_score: 0.0051
ece: 0.0043
f1: 0.3783
fn: 1164
fp: 1285
pr_auc: 0.3502
precision: 0.3670
recall: 0.3903
roc_auc: 0.9834
tn: 351798
tp: 745

Regression Metrics (Temperature):
mae: 1.9496
mape: 23.1998
r2: 0.9177
rmse: 2.5378

Generating reliability diagram...

============================================================
Summary Report
============================================================

3h Horizon:
  Frost - Brier: 0.0027, ECE: 0.0009, ROC-AUC: 0.9965
  Temp  - MAE: 1.1950, RMSE: 1.5792, R²: 0.9681

6h Horizon:
  Frost - Brier: 0.0036, ECE: 0.0019, ROC-AUC: 0.9929
  Temp  - MAE: 1.5938, RMSE: 2.0713, R²: 0.9452

12h Horizon:
  Frost - Brier: 0.0038, ECE: 0.0020, ROC-AUC: 0.9883
  Temp  - MAE: 1.8365, RMSE: 2.3952, R²: 0.9267

24h Horizon:
  Frost - Brier: 0.0051, ECE: 0.0043, ROC-AUC: 0.9834
  Temp  - MAE: 1.9496, RMSE: 2.5378, R²: 0.9177

✅ Training completed!
Results saved to: experiments/catboost/top175_features

============================================================
LOSO (Leave-One-Station-Out) Evaluation
============================================================
Freed memory: released full dataset from RAM
Loading data from disk: experiments/catboost/top175_features/labeled_data.parquet
Loaded 2367360 rows, 321 columns
Memory usage: 4.06 GB
Memory usage after optimization: 4.02 GB
Found 18 stations: [np.int16(2), np.int16(7), np.int16(15), np.int16(39), np.int16(47), np.int16(70), np.int16(71), np.int16(80), np.int16(105), np.int16(124), np.int16(125), np.int16(131), np.int16(146), np.int16(182), np.int16(194), np.int16(195), np.int16(205), np.int16(206)]
Freed full dataset from memory - will reload per station on-demand

============================================================
LOSO Evaluation: Processing 18 stations
   Memory optimization: Load data on-demand, free after each station
   Horizons: [3, 6, 12, 24]
============================================================

============================================================
[1/18] Processing Station 2
   Train stations: 17, Test station: 2
============================================================
  Loading data for station 2...
  Memory usage: 4.02 GB
  Train samples: 2235840, Test samples: 131520

  Processing 3h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235789, Test samples: 131517
    ✅ Brier=0.0042, ECE=0.0010, ROC-AUC=0.9974, MAE=1.6815°C

  Processing 6h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235738, Test samples: 131514
    ✅ Brier=0.0054, ECE=0.0031, ROC-AUC=0.9953, MAE=2.1610°C

  Processing 12h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235636, Test samples: 131508
    ✅ Brier=0.0065, ECE=0.0027, ROC-AUC=0.9924, MAE=2.0963°C

  Processing 24h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235432, Test samples: 131496
    ✅ Brier=0.0071, ECE=0.0019, ROC-AUC=0.9891, MAE=2.0981°C
  Freed memory: released station 2 data

  ✅ Station 2 completed and saved!
     Progress: 1/18 stations

============================================================
[2/18] Processing Station 7
   Train stations: 17, Test station: 7
============================================================
  Loading data for station 7...
  Memory usage: 4.02 GB
  Train samples: 2235840, Test samples: 131520

  Processing 3h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235789, Test samples: 131517
    ✅ Brier=0.0030, ECE=0.0016, ROC-AUC=0.9980, MAE=1.5204°C

  Processing 6h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235738, Test samples: 131514
    ✅ Brier=0.0045, ECE=0.0025, ROC-AUC=0.9921, MAE=2.0648°C

  Processing 12h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235636, Test samples: 131508
    ✅ Brier=0.0049, ECE=0.0015, ROC-AUC=0.9894, MAE=1.9924°C

  Processing 24h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235432, Test samples: 131496
    ✅ Brier=0.0052, ECE=0.0010, ROC-AUC=0.9876, MAE=2.0156°C
  Freed memory: released station 7 data

  ✅ Station 7 completed and saved!
     Progress: 2/18 stations

============================================================
[3/18] Processing Station 15
   Train stations: 17, Test station: 15
============================================================
  Loading data for station 15...
  Memory usage: 4.02 GB
  Train samples: 2235840, Test samples: 131520

  Processing 3h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235789, Test samples: 131517
    ✅ Brier=0.0036, ECE=0.0019, ROC-AUC=0.9979, MAE=1.7149°C

  Processing 6h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235738, Test samples: 131514
    ✅ Brier=0.0050, ECE=0.0035, ROC-AUC=0.9956, MAE=2.2088°C

  Processing 12h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235636, Test samples: 131508
    ✅ Brier=0.0064, ECE=0.0022, ROC-AUC=0.9916, MAE=2.1170°C

  Processing 24h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235432, Test samples: 131496
    ✅ Brier=0.0067, ECE=0.0017, ROC-AUC=0.9893, MAE=2.1314°C
  Freed memory: released station 15 data

  ✅ Station 15 completed and saved!
     Progress: 3/18 stations

============================================================
[4/18] Processing Station 39
   Train stations: 17, Test station: 39
============================================================
  Loading data for station 39...
  Memory usage: 4.02 GB
  Train samples: 2235840, Test samples: 131520

  Processing 3h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235789, Test samples: 131517
    ✅ Brier=0.0026, ECE=0.0016, ROC-AUC=0.9982, MAE=1.5801°C

  Processing 6h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235738, Test samples: 131514
    ✅ Brier=0.0035, ECE=0.0022, ROC-AUC=0.9961, MAE=2.0481°C

  Processing 12h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235636, Test samples: 131508
    ✅ Brier=0.0044, ECE=0.0024, ROC-AUC=0.9923, MAE=1.9899°C

  Processing 24h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235432, Test samples: 131496
    ✅ Brier=0.0047, ECE=0.0023, ROC-AUC=0.9906, MAE=2.0408°C
  Freed memory: released station 39 data

  ✅ Station 39 completed and saved!
     Progress: 4/18 stations

============================================================
[5/18] Processing Station 47
   Train stations: 17, Test station: 47
============================================================
  Loading data for station 47...
  Memory usage: 4.02 GB
  Train samples: 2235840, Test samples: 131520

  Processing 3h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235789, Test samples: 131517
    ✅ Brier=0.0013, ECE=0.0009, ROC-AUC=0.9968, MAE=1.6371°C

  Processing 6h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235738, Test samples: 131514
    ✅ Brier=0.0019, ECE=0.0016, ROC-AUC=0.9936, MAE=2.1277°C

  Processing 12h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235636, Test samples: 131508
    ✅ Brier=0.0026, ECE=0.0030, ROC-AUC=0.9896, MAE=2.0845°C

  Processing 24h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235432, Test samples: 131496
    ✅ Brier=0.0026, ECE=0.0033, ROC-AUC=0.9759, MAE=2.0818°C
  Freed memory: released station 47 data

  ✅ Station 47 completed and saved!
     Progress: 5/18 stations

============================================================
[6/18] Processing Station 70
   Train stations: 17, Test station: 70
============================================================
  Loading data for station 70...
  Memory usage: 4.02 GB
  Train samples: 2235840, Test samples: 131520

  Processing 3h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235789, Test samples: 131517
    ✅ Brier=0.0039, ECE=0.0014, ROC-AUC=0.9967, MAE=1.5763°C

  Processing 6h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235738, Test samples: 131514
    ✅ Brier=0.0054, ECE=0.0023, ROC-AUC=0.9931, MAE=2.0596°C

  Processing 12h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235636, Test samples: 131508
    ✅ Brier=0.0064, ECE=0.0023, ROC-AUC=0.9909, MAE=2.0186°C

  Processing 24h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235432, Test samples: 131496
    ✅ Brier=0.0068, ECE=0.0026, ROC-AUC=0.9902, MAE=2.0220°C
  Freed memory: released station 70 data

  ✅ Station 70 completed and saved!
     Progress: 6/18 stations

============================================================
[7/18] Processing Station 71
   Train stations: 17, Test station: 71
============================================================
  Loading data for station 71...
  Memory usage: 4.02 GB
  Train samples: 2235840, Test samples: 131520

  Processing 3h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235789, Test samples: 131517
    ✅ Brier=0.0048, ECE=0.0010, ROC-AUC=0.9968, MAE=1.7148°C

  Processing 6h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235738, Test samples: 131514
    ✅ Brier=0.0069, ECE=0.0018, ROC-AUC=0.9913, MAE=2.2453°C

  Processing 12h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235636, Test samples: 131508
    ✅ Brier=0.0087, ECE=0.0025, ROC-AUC=0.9893, MAE=2.0755°C

  Processing 24h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235432, Test samples: 131496
    ✅ Brier=0.0091, ECE=0.0020, ROC-AUC=0.9872, MAE=2.0671°C
  Freed memory: released station 71 data

  ✅ Station 71 completed and saved!
     Progress: 7/18 stations

============================================================
[8/18] Processing Station 80
   Train stations: 17, Test station: 80
============================================================
  Loading data for station 80...
  Memory usage: 4.02 GB
  Train samples: 2235840, Test samples: 131520

  Processing 3h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235789, Test samples: 131517
    ✅ Brier=0.0025, ECE=0.0017, ROC-AUC=0.9987, MAE=1.5885°C

  Processing 6h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235738, Test samples: 131514
    ✅ Brier=0.0036, ECE=0.0025, ROC-AUC=0.9964, MAE=2.0909°C

  Processing 12h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235636, Test samples: 131508
    ✅ Brier=0.0047, ECE=0.0026, ROC-AUC=0.9914, MAE=2.0333°C

  Processing 24h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235432, Test samples: 131496
    ✅ Brier=0.0049, ECE=0.0024, ROC-AUC=0.9910, MAE=2.0656°C
  Freed memory: released station 80 data

  ✅ Station 80 completed and saved!
     Progress: 8/18 stations

============================================================
[9/18] Processing Station 105
   Train stations: 17, Test station: 105
============================================================
  Loading data for station 105...
  Memory usage: 4.02 GB
  Train samples: 2235840, Test samples: 131520

  Processing 3h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235789, Test samples: 131517
    ✅ Brier=0.0050, ECE=0.0017, ROC-AUC=0.9963, MAE=1.8903°C

  Processing 6h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235738, Test samples: 131514
    ✅ Brier=0.0069, ECE=0.0028, ROC-AUC=0.9929, MAE=2.3961°C

  Processing 12h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235636, Test samples: 131508
    ✅ Brier=0.0086, ECE=0.0029, ROC-AUC=0.9889, MAE=2.3129°C

  Processing 24h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235432, Test samples: 131496
    ✅ Brier=0.0090, ECE=0.0021, ROC-AUC=0.9865, MAE=2.2757°C
  Freed memory: released station 105 data

  ✅ Station 105 completed and saved!
     Progress: 9/18 stations

============================================================
[10/18] Processing Station 124
   Train stations: 17, Test station: 124
============================================================
  Loading data for station 124...
  Memory usage: 4.02 GB
  Train samples: 2235840, Test samples: 131520

  Processing 3h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235789, Test samples: 131517
    ✅ Brier=0.0025, ECE=0.0011, ROC-AUC=0.9983, MAE=1.6754°C

  Processing 6h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235738, Test samples: 131514
    ✅ Brier=0.0032, ECE=0.0018, ROC-AUC=0.9968, MAE=2.1727°C

  Processing 12h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235636, Test samples: 131508
    ✅ Brier=0.0043, ECE=0.0022, ROC-AUC=0.9947, MAE=2.0385°C

  Processing 24h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235432, Test samples: 131496
    ✅ Brier=0.0049, ECE=0.0016, ROC-AUC=0.9924, MAE=2.0569°C
  Freed memory: released station 124 data

  ✅ Station 124 completed and saved!
     Progress: 10/18 stations

============================================================
[11/18] Processing Station 125
   Train stations: 17, Test station: 125
============================================================
  Loading data for station 125...
  Memory usage: 4.02 GB
  Train samples: 2235840, Test samples: 131520

  Processing 3h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235789, Test samples: 131517
    ✅ Brier=0.0022, ECE=0.0010, ROC-AUC=0.9981, MAE=1.7708°C

  Processing 6h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235738, Test samples: 131514
    ✅ Brier=0.0028, ECE=0.0015, ROC-AUC=0.9967, MAE=2.2809°C

  Processing 12h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235636, Test samples: 131508
    ✅ Brier=0.0038, ECE=0.0010, ROC-AUC=0.9932, MAE=2.2306°C

  Processing 24h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235432, Test samples: 131496
    ✅ Brier=0.0040, ECE=0.0009, ROC-AUC=0.9897, MAE=2.2717°C
  Freed memory: released station 125 data

  ✅ Station 125 completed and saved!
     Progress: 11/18 stations

============================================================
[12/18] Processing Station 131
   Train stations: 17, Test station: 131
============================================================
  Loading data for station 131...
  Memory usage: 4.02 GB
  Train samples: 2235840, Test samples: 131520

  Processing 3h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235789, Test samples: 131517
    ✅ Brier=0.0014, ECE=0.0006, ROC-AUC=0.9986, MAE=1.5505°C

  Processing 6h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235738, Test samples: 131514
    ✅ Brier=0.0020, ECE=0.0014, ROC-AUC=0.9969, MAE=2.0498°C

  Processing 12h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235636, Test samples: 131508
    ✅ Brier=0.0027, ECE=0.0023, ROC-AUC=0.9921, MAE=2.1115°C

  Processing 24h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235432, Test samples: 131496
    ✅ Brier=0.0028, ECE=0.0017, ROC-AUC=0.9847, MAE=2.1181°C
  Freed memory: released station 131 data

  ✅ Station 131 completed and saved!
     Progress: 12/18 stations

============================================================
[13/18] Processing Station 146
   Train stations: 17, Test station: 146
============================================================
  Loading data for station 146...
  Memory usage: 4.02 GB
  Train samples: 2235840, Test samples: 131520

  Processing 3h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235789, Test samples: 131517
    ✅ Brier=0.0031, ECE=0.0007, ROC-AUC=0.9973, MAE=1.7850°C

  Processing 6h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235738, Test samples: 131514
    ✅ Brier=0.0038, ECE=0.0018, ROC-AUC=0.9959, MAE=2.2191°C

  Processing 12h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235636, Test samples: 131508
    ✅ Brier=0.0049, ECE=0.0011, ROC-AUC=0.9905, MAE=2.0272°C

  Processing 24h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235432, Test samples: 131496
    ✅ Brier=0.0054, ECE=0.0009, ROC-AUC=0.9864, MAE=2.0666°C
  Freed memory: released station 146 data

  ✅ Station 146 completed and saved!
     Progress: 13/18 stations

============================================================
[14/18] Processing Station 182
   Train stations: 17, Test station: 182
============================================================
  Loading data for station 182...
  Memory usage: 4.02 GB
  Train samples: 2235840, Test samples: 131520

  Processing 3h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235789, Test samples: 131517
    ✅ Brier=0.0037, ECE=0.0012, ROC-AUC=0.9975, MAE=1.7180°C

  Processing 6h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235738, Test samples: 131514
    ✅ Brier=0.0054, ECE=0.0028, ROC-AUC=0.9944, MAE=2.1911°C

  Processing 12h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235636, Test samples: 131508
    ✅ Brier=0.0067, ECE=0.0023, ROC-AUC=0.9907, MAE=2.0922°C

  Processing 24h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235432, Test samples: 131496
    ✅ Brier=0.0073, ECE=0.0032, ROC-AUC=0.9880, MAE=2.1401°C
  Freed memory: released station 182 data

  ✅ Station 182 completed and saved!
     Progress: 14/18 stations

============================================================
[15/18] Processing Station 194
   Train stations: 17, Test station: 194
============================================================
  Loading data for station 194...
  Memory usage: 4.02 GB
  Train samples: 2235840, Test samples: 131520

  Processing 3h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235789, Test samples: 131517
    ✅ Brier=0.0043, ECE=0.0024, ROC-AUC=0.9964, MAE=1.5330°C

  Processing 6h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235738, Test samples: 131514
    ✅ Brier=0.0052, ECE=0.0019, ROC-AUC=0.9919, MAE=2.0388°C

  Processing 12h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235636, Test samples: 131508
    ✅ Brier=0.0051, ECE=0.0019, ROC-AUC=0.9903, MAE=1.9407°C

  Processing 24h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235432, Test samples: 131496
    ✅ Brier=0.0053, ECE=0.0020, ROC-AUC=0.9836, MAE=1.9423°C
  Freed memory: released station 194 data

  ✅ Station 194 completed and saved!
     Progress: 15/18 stations

============================================================
[16/18] Processing Station 195
   Train stations: 17, Test station: 195
============================================================
  Loading data for station 195...
  Memory usage: 4.02 GB
  Train samples: 2235840, Test samples: 131520

  Processing 3h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235789, Test samples: 131517
    ✅ Brier=0.0022, ECE=0.0010, ROC-AUC=0.9952, MAE=1.6813°C

  Processing 6h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235738, Test samples: 131514
    ✅ Brier=0.0031, ECE=0.0026, ROC-AUC=0.9912, MAE=2.1345°C

  Processing 12h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235636, Test samples: 131508
    ✅ Brier=0.0032, ECE=0.0027, ROC-AUC=0.9770, MAE=2.1897°C

  Processing 24h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235432, Test samples: 131496
    ✅ Brier=0.0032, ECE=0.0022, ROC-AUC=0.9563, MAE=2.1955°C
  Freed memory: released station 195 data

  ✅ Station 195 completed and saved!
     Progress: 16/18 stations

============================================================
[17/18] Processing Station 205
   Train stations: 17, Test station: 205
============================================================
  Loading data for station 205...
  Memory usage: 4.02 GB
  Train samples: 2235840, Test samples: 131520

  Processing 3h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235789, Test samples: 131517
    ✅ Brier=0.0024, ECE=0.0024, ROC-AUC=0.9958, MAE=1.7485°C

  Processing 6h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235738, Test samples: 131514
    ✅ Brier=0.0032, ECE=0.0048, ROC-AUC=0.9929, MAE=2.2745°C

  Processing 12h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235636, Test samples: 131508
    ✅ Brier=0.0030, ECE=0.0047, ROC-AUC=0.9908, MAE=2.2868°C

  Processing 24h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235432, Test samples: 131496
    ✅ Brier=0.0046, ECE=0.0080, ROC-AUC=0.9841, MAE=2.2469°C
  Freed memory: released station 205 data

  ✅ Station 205 completed and saved!
     Progress: 17/18 stations

============================================================
[18/18] Processing Station 206
   Train stations: 17, Test station: 206
============================================================
  Loading data for station 206...
  Memory usage: 4.02 GB
  Train samples: 2235840, Test samples: 131520

  Processing 3h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235789, Test samples: 131517
    ✅ Brier=0.0036, ECE=0.0013, ROC-AUC=0.9966, MAE=1.4849°C

  Processing 6h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235738, Test samples: 131514
    ✅ Brier=0.0050, ECE=0.0027, ROC-AUC=0.9930, MAE=1.9694°C

  Processing 12h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235636, Test samples: 131508
    ✅ Brier=0.0058, ECE=0.0023, ROC-AUC=0.9878, MAE=1.9396°C

  Processing 24h horizon...
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
    Train samples: 2235432, Test samples: 131496
    ✅ Brier=0.0061, ECE=0.0021, ROC-AUC=0.9842, MAE=1.9346°C
  Freed memory: released station 206 data

  ✅ Station 206 completed and saved!
     Progress: 18/18 stations

============================================================
Calculating summary statistics...
============================================================

============================================================
LOSO Summary Statistics
============================================================

3h Horizon:
  Stations evaluated: 18
  Brier Score: 0.0031 ± 0.0010
  ECE: 0.0014 ± 0.0005
  ROC-AUC: 0.9973 ± 0.0010
  PR-AUC: 0.8133 ± 0.0684
  Temp MAE: 1.6584 ± 0.1045°C
  Temp RMSE: 2.1248 ± 0.1302°C
  Temp R²: 0.9414 ± 0.0066

6h Horizon:
  Stations evaluated: 18
  Brier Score: 0.0043 ± 0.0014
  ECE: 0.0024 ± 0.0008
  ROC-AUC: 0.9942 ± 0.0019
  PR-AUC: 0.6925 ± 0.1054
  Temp MAE: 2.1518 ± 0.1049°C
  Temp RMSE: 2.7058 ± 0.1224°C
  Temp R²: 0.9049 ± 0.0094

12h Horizon:
  Stations evaluated: 18
  Brier Score: 0.0052 ± 0.0018
  ECE: 0.0024 ± 0.0008
  ROC-AUC: 0.9902 ± 0.0036
  PR-AUC: 0.5706 ± 0.1009
  Temp MAE: 2.0876 ± 0.1051°C
  Temp RMSE: 2.6888 ± 0.1268°C
  Temp R²: 0.9059 ± 0.0113

24h Horizon:
  Stations evaluated: 18
  Brier Score: 0.0055 ± 0.0018
  ECE: 0.0023 ± 0.0015
  ROC-AUC: 0.9854 ± 0.0080
  PR-AUC: 0.5270 ± 0.1034
  Temp MAE: 2.0984 ± 0.0967°C
  Temp RMSE: 2.6998 ± 0.1150°C
  Temp R²: 0.9052 ± 0.0103

✅ LOSO evaluation completed!
Results saved to: experiments/catboost/top175_features/loso
