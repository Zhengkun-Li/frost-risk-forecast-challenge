Output directory: experiments/catboost/top175_features

============================================================
Step 1: Loading Data
============================================================
Loading 18 station files from /home/zhengkun-li/frost-risk-forecast-challenge/data/raw/frost-risk-forecast-challenge/stations...
  Loaded 5/18 files...  Loaded 10/18 files...  Loaded 15/18 files...  Loaded 18/18 files...
Combining 18 station DataFrames...
Combined data: 2367360 rows, 26 columns
Stations: 18
Loaded 2367360 rows, 26 columns
Optimizing data types to reduce memory...
Memory usage after optimization: 1.50 GB

============================================================
Step 2: Cleaning Data
============================================================
After cleaning: 2367360 rows

============================================================
Step 3: Feature Engineering
============================================================
After feature engineering: 2367360 rows, 313 columns
Memory usage: 3.95 GB
Optimizing feature data types...
Memory usage after optimization: 3.95 GB

============================================================
Step 4: Creating Frost Labels
============================================================
  3h horizon: 20579.0/2367360 frost events (0.87%)
  6h horizon: 20579.0/2367360 frost events (0.87%)
  12h horizon: 20579.0/2367360 frost events (0.87%)
  24h horizon: 20579.0/2367360 frost events (0.87%)

Saved labeled data to experiments/catboost/top175_features/labeled_data.parquet

Using top 175 features based on importance
  Importance file: /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv

============================================================
Training models for 3h horizon
============================================================
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
Features: 175
Samples: 2367306
Frost events: 20579.0 (0.87%)
Train: 1657078, Val: 355087, Test: 355090

Training classification model for frost probability...
Training regression model for temperature...

Evaluating on test set...

Classification Metrics (Frost Probability):
accuracy: 0.9964
brier_score: 0.0027
ece: 0.0009
f1: 0.6555
fn: 700
fp: 571
pr_auc: 0.7184
precision: 0.6792
recall: 0.6333
roc_auc: 0.9965
tn: 352610
tp: 1209

Regression Metrics (Temperature):
mae: 1.1950
mape: 13.0662
r2: 0.9681
rmse: 1.5792

Generating reliability diagram...

============================================================
Training models for 6h horizon
============================================================
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
Features: 175
Samples: 2367252
Frost events: 20579.0 (0.87%)
Train: 1657004, Val: 355070, Test: 355076

Training classification model for frost probability...
Training regression model for temperature...

Evaluating on test set...

Classification Metrics (Frost Probability):
accuracy: 0.9952
brier_score: 0.0036
ece: 0.0019
f1: 0.5311
fn: 935
fp: 785
pr_auc: 0.5382
precision: 0.5537
recall: 0.5102
roc_auc: 0.9929
tn: 352382
tp: 974

Regression Metrics (Temperature):
mae: 1.5938
mape: 17.7774
r2: 0.9452
rmse: 2.0713

Generating reliability diagram...

============================================================
Training models for 12h horizon
============================================================
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
Features: 175
Samples: 2367144
Frost events: 20579.0 (0.87%)
Train: 1656856, Val: 355036, Test: 355048

Training classification model for frost probability...
Training regression model for temperature...

Evaluating on test set...

Classification Metrics (Frost Probability):
accuracy: 0.9949
brier_score: 0.0038
ece: 0.0020
f1: 0.4733
fn: 1102
fp: 694
pr_auc: 0.4914
precision: 0.5376
recall: 0.4227
roc_auc: 0.9883
tn: 352445
tp: 807

Regression Metrics (Temperature):
mae: 1.8365
mape: 20.8520
r2: 0.9267
rmse: 2.3952

Generating reliability diagram...

============================================================
Training models for 24h horizon
============================================================
  Applying feature selection...
    Original features: 298
    Loaded feature importance from /home/zhengkun-li/frost-risk-forecast-challenge/experiments/lightgbm/feature_importance/feature_importance_3h_all.csv
  After selecting by importance: 175 features
    Selected features: 175
    Removed features: 123
Features: 175
Samples: 2366928
Frost events: 20579.0 (0.87%)
Train: 1656561, Val: 354967, Test: 354992

Training classification model for frost probability...
Training regression model for temperature...

Evaluating on test set...

Classification Metrics (Frost Probability):
accuracy: 0.9931
brier_score: 0.0051
ece: 0.0043
f1: 0.3783
fn: 1164
fp: 1285
pr_auc: 0.3502
precision: 0.3670
recall: 0.3903
roc_auc: 0.9834
tn: 351798
tp: 745

Regression Metrics (Temperature):
mae: 1.9496
mape: 23.1998
r2: 0.9177
rmse: 2.5378

Generating reliability diagram...

============================================================
Summary Report
============================================================

3h Horizon:
  Frost - Brier: 0.0027, ECE: 0.0009, ROC-AUC: 0.9965
  Temp  - MAE: 1.1950, RMSE: 1.5792, R²: 0.9681

6h Horizon:
  Frost - Brier: 0.0036, ECE: 0.0019, ROC-AUC: 0.9929
  Temp  - MAE: 1.5938, RMSE: 2.0713, R²: 0.9452

12h Horizon:
  Frost - Brier: 0.0038, ECE: 0.0020, ROC-AUC: 0.9883
  Temp  - MAE: 1.8365, RMSE: 2.3952, R²: 0.9267

24h Horizon:
  Frost - Brier: 0.0051, ECE: 0.0043, ROC-AUC: 0.9834
  Temp  - MAE: 1.9496, RMSE: 2.5378, R²: 0.9177

✅ Training completed!
Results saved to: experiments/catboost/top175_features
